---
title: "Computación Estadística EPG3308"
pagetitle: "03-AED-Viz-Estadística-Descriptiva-ggplot2"
subtitle: "03 AED Viz Estadística Descriptiva <code><small>ggplot2</small></code>"
author: "<br>Joshua Kunst<br>@jbkunst"
date: '`r Sys.Date()`'
output:
  xaringan::moon_reader:
    self_contained: no
    css: ["css/xaringan-themer.css", "css/styles.css"]
    lib_dir: libs    
    nature:
      titleSlideClass: ["left", "middle"]
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
source(here::here("slides/xaringan-knitr-setup.R"))
library(flipbookr)
```

## ¿Existe el mejor gráfico? 

Queremos comunicar: _La región del sur exhibe el mayor crecimiento en ventas._

Ejemplo adapatado del tweet de [Lisa Charlotte Rost](https://twitter.com/lisacrost/status/948233069110222848)
que a su vez está viene del ejemplo del libro "Show me the numbers" de Stephen Few


Los datos:

```{r, echo=FALSE}
library(readxl)
library(tidyverse)

datosq <- read_excel(here::here("data/muestrame_los_numeros.xlsx")) |> 
  mutate(region = factor(region, levels = c("sur", "norte", "este", "oeste")))

datosq |> 
  # spread(cuarto, valor) |> 
  arrange(region) |> 
  glimpse() 
```

---

## Opción #1

```{r, echo=FALSE}
sfv <- scale_fill_viridis_d(option = "D", begin = 0.1, end = 0.90)
scv <- scale_color_viridis_d(option = "D", begin = 0.1, end = 0.90)
rmv <- labs(fill = NULL, color = NULL, x = NULL, y = NULL)
ttl <- labs(title = "La región del sur exhibe el mayor crecimiento")

p1 <- ggplot(datosq) +
  geom_col(aes(cuarto, valor, group = region, fill = region),
           color = "gray90", position = "dodge") +
  sfv +
  rmv
  
p1 + ttl
```

---

## Opción #2

```{r, echo=FALSE}
p2 <- ggplot(datosq) +
  geom_col(aes(region, valor, group = cuarto, fill = region),
           color = "gray90", position = "dodge") +
  sfv +
  rmv
  
p2 + ttl
```

---

## Opción #3

```{r, echo=FALSE}
p3 <- ggplot(datosq) +
  geom_line(aes(cuarto, valor, group = region, color = region), size = 2.5) +
  scv +
  rmv

p3 + ttl
```

---

## ¿Cuál es la mejor?

```{r, echo=FALSE}
library(patchwork)

(p1 | p2 | p3) & theme(legend.position = "none") 
```

---

```{r, include=FALSE}
ggplot2::theme_set(theme_flipboork)
```

```{r datosq, include = FALSE}
datosq |> 
  mutate(es_sur = ifelse(region == "sur", 1, 0)) |> 
  ggplot() +
  geom_line(aes(x = cuarto, y = valor,
                group = region, 
                color = es_sur, 
                size = es_sur),
            lineend = "round") +
  scale_color_gradient(low = "#00000020", high = "darkred") +
  scale_size_continuous(range = c(1.5, 3)) +
  scale_y_continuous(position = "right", limits = c(70, 320)) + 
  theme_minimal(base_size = 7) +
  theme(legend.position = "none") +
  labs(x = NULL, y = NULL) +
  labs(
    title = "Sur exhibe el mayor crecimiento con un 234% anual")
```

`r flipbookr::chunk_reveal("datosq", break_type = "auto", title = "## Ejemplo layers", widths = c(1, 1), chunk_options = "fig.height = 2.7, fig.width = 3")`


